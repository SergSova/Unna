function changeImgs(e,t){imgPrev=e.find("img").attr("src"),imgNext=t.find("img").attr("src"),$(".apart_slider_nav .prev_image div").hide().fadeIn(600).css("background-image","url("+imgPrev+")"),$(".apart_slider_nav .next_image div").hide().fadeIn(600).css("background-image","url("+imgNext+")")}function onInitApartSlider(){var e=$(".apart_slider .slick-current"),t=e.next(),i=$(".apart_slider .slick-slide").length;changeImgs($('.apart_slider .slick-slide[data-slick-index="'+(i-1)+'"]'),t)}function scrollParam(e){var t=e.mcs.draggerTop,i=$(".apart.current"),r=[];$(".apart").each(function(){r.push($(this).offset().top)});var a=closest(t,r);i.removeClass("current"),$(".apart:nth-child("+a+")").addClass("current"),$(".premises_filter input[type=radio]").prop("checked",!1),$(".premises_filter li:nth-child("+a+") input[type=radio]").prop("checked",!0)}function closest(e,t){for(var i=t[0],r=0,a=Math.abs(e-i),s=0;s<t.length;s++){var n=Math.abs(e-t[s]);n<a&&(a=n,i=t[s],r=s)}return r+=1}function initRangeFilter(){var e=100*leftHandle.outerWidth()/$(".range-slider").width(),t=100*rightHandle.outerWidth()/$(".range-slider").width(),i=rightHandle.outerWidth(),r=leftHandle.closest(".range-slider"),a=r.width(),s=100-e-t;leftLine.width(0).css("left","0%"),rightLine.width(0).css("left","100%"),rightHandle.css("left",a-i-1),centerLine.width(s+"%").css("left",leftHandle.outerWidth()),leftHandle.css("left",parseInt(leftHandle.css("left"))/(leftHandle.parent().width()/100)+"%"),rightHandle.css("left",parseInt(rightHandle.css("left"))/(rightHandle.parent().width()/100)+"%")}function onResizeRangeFilter(){$(".range-slider").each(function(){var e=$(this),t=(e.find(".ui-slider-range-left"),e.find(".ui-slider-range-right")),i=e.find(".ui-slider-range"),r=e.find(".left-handle"),a=e.find(".right-handle"),s=e.width(),n=100*parseInt(r.css("left"))/s;lftHW=100*r.outerWidth()/s,rgtHW=100*a.outerWidth()/s,rgtHP=100*parseInt(a.css("left"))/s,rgtLW=100-(rgtHP+rgtHW),cntrHP=n+lftHW,cntrHW=100-(cntrHP+100-rgtHP),i.css("left",cntrHP+"%").width(cntrHW+"%"),t.css("left",rgtHP+rgtHW+"%")}),$(".left-handle").each(function(){var e=$(this),t=$(".range-slider").width(),i=100*parseInt(e.css("left"))/t,r=2.61*$(window).width()/100,a=i/100*r+4;$(this).css("left",parseInt($(this).css("left"))/($(this).parent().width()/100)+"%"),$(this).hasClass("moved")&&($(this).width(a).height(a),mgnCircle=e.outerWidth()/2,e.css("margin-top",-mgnCircle)),startMove(this,1),rangeFilter(this,1),changeValues(this,2)}),$(".right-handle").each(function(){var e=$(this),t=$(".range-slider").width(),i=100*parseInt(e.css("left"))/t,r=2.61*$(window).width()/100,a=i/100*r+4;$(this).css("left",parseInt($(this).css("left"))/($(this).parent().width()/100)+"%"),$(this).hasClass("moved")&&($(this).width(a).height(a),mgnCircle=e.outerWidth()/2,e.css("margin-top",-mgnCircle)),startMove(this,2),rangeFilter(this,2),changeValues(this,2)})}function rangeFilter(e,t){var i=$(e),r=$(".range-slider").width(),a=parseInt(i.css("left")),s=100*i.outerWidth()/r,n=100*a/r,l=i.closest(".range-slider").find(".ui-slider-range");i.closest(".range-slider");1==t?(rightHandle=i.closest(".range-slider").find(".right-handle"),rightPos=100*parseInt(rightHandle.css("left"))/r,leftPos=100*(a+s)/r,line=i.closest(".range-slider").find(".ui-slider-range-left"),widhtCenter=100-(n+s+(100-rightPos)),line.width(n+"%"),l.css("left",n+s+"%").width(widhtCenter+"%"),mgnCircle=i.outerWidth()/2,i.css("margin-top",-mgnCircle)):(leftHandle=i.closest(".range-slider").find(".left-handle"),leftWidth=100*leftHandle.outerWidth()/r,leftPos=100*parseInt(leftHandle.css("left"))/r,rightPos=100*a/r,widhtCenter=100-(leftWidth+leftPos+(100-rightPos)),line=i.closest(".range-slider").find(".ui-slider-range-right"),line.width(100-n-s+"%").css("left",n+s+"%"),l.css("left",leftWidth+leftPos+"%").width(widhtCenter+"%"),mgnCircle=i.outerWidth()/2,i.css("margin-top",-mgnCircle))}function changeValues(e,t){var i=$(e).closest(".range-slider"),r=$(".range-slider").width(),a=i.find(".left-limit-value"),s=i.find(".right-limit-value"),n=i.find(".left-handle"),l=100*parseInt(n.css("left"))/r,o=i.find(".right-handle"),h=100*parseInt(o.css("left"))/r,d=100*o.outerWidth()/r,c=a.data("value"),p=s.data("value"),g=p-c,f=Math.round(l*g/100+c),m=Math.round((h+d)*g/100+c),u=i.find("input[name=full-area-from]"),v=i.find("input[name=full-area-to]");0==u.length&&(u=i.find("input[name=price-from]"),v=i.find("input[name=price-to]")),1==t?(n.attr("data-value",f),u.val(f)):(o.attr("data-value",m),v.val(m))}function startMove(e,t){var i=$(e),r=i.closest(".range-slider"),a=$(".range-slider").width(),s=100*$(e).outerWidth()/a,n=100*parseInt(i.css("left"))/a,l=r.find(".left-limit-value"),o=r.find(".right-limit-value");circle=2.61*$(window).width()/100,widthH=n/100*circle+4,i.addClass("moved").width(widthH).height(widthH),(0==n||n+s>=100)&&i.removeClass("moved").css({width:"2.61vw",height:"2.61vw"}),window.matchMedia("(max-width: 1024px)").matches&&(circle=7.2*$(window).width()/100,widthH=n/100*circle+4,widthH<11&&(widthH=11),i.addClass("moved").width(widthH).height(widthH),(0==n||n+s>=100)&&i.removeClass("moved").css({width:"7.2vmin",height:"7.2vmin"})),1==t?n>0?l.fadeIn():l.hide():n+s<100?o.fadeIn():o.hide()}function rightMoveLimit(e,t){var i=$(e),r=i.outerWidth(),a=i.closest(".range-slider"),s=a.find(".left-handle"),n=s.outerWidth(),l=parseInt(s.css("left")),o=a.width();return t>=o-r?t=o-r:t<=n+l&&(t=n+l),t}function leftMoveLimit(e,t){var i=$(e),r=i.outerWidth(),a=i.closest(".range-slider"),s=a.find(".right-handle"),n=parseInt(s.css("left"));return t+r>=n&&(t=n-r),t}function hoverSvg(e){var t=$(e),i=t.data("link"),r=t.closest(".premise_media").find("a[data-link="+i+"]"),a=t.closest(".premise").find(".premise_info td:nth-child(1) .num"),s=t.closest(".premise").find(".premise_info td:nth-child(2) .num"),n=r.data("size"),l=r.data("price");t.closest("svg").find("polygon, path, rect").removeClass("active"),t.addClass("active"),n&&a.hide().html(n+"<span>м<sup>2</sup></span>").stop().fadeIn(700),l&&s.hide().html(l+"<span>грн/м<sup>2</sup></span>").stop().fadeIn(700)}function getCookie(e){for(var t=e+"=",i=decodeURIComponent(document.cookie),r=i.split(";"),a=0;a<r.length;a++){for(var s=r[a];" "==s.charAt(0);)s=s.substring(1);if(0==s.indexOf(t))return s.substring(t.length,s.length)}return""}if($(".apart_slider").slick({infinite:!0,slidesToShow:1,slidesToScroll:1,fade:!0,arrows:!0,speed:600}),window.matchMedia("(min-width: 992px)").matches){var apartHeight=$(".apart .left_block").height(),apartInfo=$(".apart_info").outerHeight(!0),roomsHeight=apartHeight-apartInfo+5;$(".apart").height(apartHeight),$(".rooms ol").height(roomsHeight)}if($(".apart_inside_page").animate({opacity:1},600),$(".aparts").animate({opacity:1},200),sliderFlag=0,$(".apart_slider").on("beforeChange",function(e,t,i,r){var a=$(".apart_slider .slick-slide").length,s=r+1;s>=a&&(s=0),sliderFlag>r?i-2<0?i=a-1:i-=2:r==a-1&&(i=r-1,s=0),changeImgs($(this).find('.slick-slide[data-slick-index="'+i+'"]'),$(this).find('.slick-slide[data-slick-index="'+s+'"]')),sliderFlag=r}),$(".apart .next_image").on("click",function(){$(".slick-next").click()}),$(".apart .prev_image").on("click",function(){$(".slick-prev").click()}),onInitApartSlider(),window.matchMedia("(min-width: 992px)").matches){var apartHeight=$(".apart .left_block").height(),apartInfo=$(".apart_info").outerHeight(!0),roomsHeight=apartHeight-apartInfo+5;$(".apart").height(apartHeight),setTimeout(function(){apartHeight=$(".apart .left_block").height(),$(".apart_inside").height(apartHeight),$(".parent_premise").height($(".parent_premise > div").height())},100),$(".rooms ol").height(roomsHeight),$(".wrap_parent_premise").height(roomsHeight),$(".rooms ol").mCustomScrollbar();var share=$(".apart .share").height()+10,amount;amount=10!=share?$(".apart:first-child").outerHeight(!0)-share:$(".apart:first-child").outerHeight(!0),$(".app-list").mCustomScrollbar({alwaysShowScrollbar:1,mouseWheel:{scrollAmount:amount},callbacks:{onScroll:function(){var e=this.mcs.draggerTop,t=$(".apart.current"),i=[];$(".apart").each(function(){i.push($(this).offset().top)});var r=closest(e,i);t.removeClass("current"),$(".apart:nth-child("+r+")").addClass("current"),$(".premises_filter input[type=radio]").prop("checked",!1),$(".premises_filter li:nth-child("+r+") input[type=radio]").prop("checked",!0)}},advanced:{updateOnContentResize:!0}});var scrollFlag=!0;$(".prem-list").mCustomScrollbar({alwaysShowScrollbar:1,mouseWheel:{scrollAmount:amount},callbacks:{whileScrolling:function(e){var t=this.mcs.top;t<=20-amount&&scrollFlag&&(scrollFlag=!1,$(".prem-list").mCustomScrollbar("stop",!0),scrollParam(this)),t>-100&&(scrollFlag=!0)},onScroll:function(){scrollParam(this)}},advanced:{updateOnContentResize:!0}}),$(window).on("resize",function(){share=$(".apart .share").height()+10,apartHeight=$(".apart .left_block").height(),apartInfo=$(".apart_info").outerHeight(!0),roomsHeight=apartHeight-apartInfo,$(".apart").height(apartHeight),$(".rooms ol").height(roomsHeight),$(".wrap_parent_premise").height(roomsHeight),$(".parent_premise").height($(".parent_premise > div").height()),amount=$(".apart.current").outerHeight(!0)-share,$(".aparts_list").mCustomScrollbar("update",{mouseWheel:{scrollAmount:amount}})})}lightbox.option({albumLabel:"%1/%2",positionFromTop:0,wrapAround:!0,resizeDuration:300,imageFadeDuration:400}),$("a").on("click",function(){$(this).attr("data-lightbox")&&$(".wrapper").addClass("lightboxOpened")}),$(window).on("resize",function(){$("#lightboxOverlay").hide(),$("#lightbox").hide(),$(".wrapper").removeClass("lightboxOpened")}),$("#lightbox, #lightbox .lb-close").on("click",function(){$(".wrapper").removeClass("lightboxOpened")}),$(".premises_filter input[type=radio]").on("click",function(){floor=$(this).data("floor"),floorDiv=$(".premise[data-floor="+floor+"]"),topF=floorDiv.position().top,$(".aparts_list").mCustomScrollbar("scrollTo",topF)});var leftLine=$(".ui-slider-range-left"),rightLine=$(".ui-slider-range-right"),centerLine=$(".ui-slider-range"),leftHandle=$(".left-handle"),rightHandle=$(".right-handle");$(".left-handle, .right-handle").on("mousedown",function(){$(this).hasClass("left-handle")?(startMove(this,1),rangeFilter(this,1)):(startMove(this,2),rangeFilter(this,2))}),0!=leftHandle.length&&leftHandle.draggable({axis:"x",containment:"parent",drag:function(e,t){var i=t.position.left;t.position.left=leftMoveLimit(this,i),startMove(this,1),rangeFilter(this,1),changeValues(this,1)},stop:function(){$(this).css("left",parseInt($(this).css("left"))/($(this).parent().width()/100)+"%"),filterApart(this)}}),0!=rightHandle.length&&rightHandle.draggable({axis:"x",containment:"parent",drag:function(e,t){var i=t.position.left;t.position.left=rightMoveLimit(this,i),startMove(this,2),rangeFilter(this,2),changeValues(this,2)},stop:function(){$(this).css("left",parseInt($(this).css("left"))/($(this).parent().width()/100)+"%"),filterApart(this)}}),initRangeFilter(),$(window).on("resize",function(){onResizeRangeFilter()});var firstElem1=$(".apart:nth-child(1) polygon[data-link=1]"),firstElem2=$(".apart:nth-child(2) path[data-link=1]");hoverSvg(firstElem1),hoverSvg(firstElem2),$("polygon, path, rect").on("mouseover",function(){hoverSvg(this)}),$(".premise_media polygon, premise_media path, .premise_media rect, .parent_premise polygon, parent_premise path, .parent_premise rect").on("click",function(){var e=$(this).data("link"),t=$(this).closest("div").find("a[data-link="+e+"]"),i=t.attr("href");i&&(window.location.href=i,document.cookie="room="+e+";path=/;domain=")});var room=getCookie("room"),premise=$(".parent_premise *[data-link=1]");room&&(premise=$(".parent_premise *[data-link="+room+"]")),hoverSvg(premise),$(".parent_premise svg").on("mouseleave",function(){hoverSvg(premise)});var wrap=$(".wrapper"),appendClose=new $.Deferred;appendClose.resolve(wrap.find(".form-wrap").append('<div class="slider-close"><svg xmlns="http://www.w3.org/2000/svg" width="34" height="34"><path style="fill: none;stroke:#fff;stroke-width:1.5px;" d="M0,0 22,22M22,0 0,22 "></path></svg></div>')),wrap.find(".show_more").click(function(e){e.preventDefault(),wrap.find(".form-wrap").addClass("active")}),appendClose.done(wrap.find(".slider-close").click(function(){wrap.find(".form-wrap").removeClass("active")})),wrap.find("textarea").parent().append('<div class="hide-textarea"><span></span></div>');var hideText=wrap.find(".hide-textarea span");wrap.find("textarea").keyup(function(){hideText.html($(this).val()),$(this).css({height:hideText.height()+"px"})});